---
title: "Projekt3"
author: "Anna Golak, Katarzyna Wr贸bel"
date: "2024-01-20"
output:   
  html_document:
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: yes
---
Pakiety, kt贸rych u偶ywam
```{r message=FALSE, warning=FALSE, paged.print=FALSE}
library(MASS)
library(kableExtra)
library(ggplot2)
library(moments)
library(dplyr)
```
Ustawiam ziarno
```{r}
set.seed(100)
```

# Charakterystyka rozkadu logarytmiczno - normalnego

**Rozkad logarytmiczno - normalny** - cigy rozkad prawdopodobiestwa dodatniej zmiennej losowej, kt贸rej logarytm ma rozkad normalny.

Niech zmienna losowa Y ma rozkad normalny z parametrami m i s . W贸wczas zmienna losowa $$X=e^Y$$ ma rozkad logarytniczno normalny. Gsto prawdopodobiestwa jest okrelana wzorem $$
f(x | \mu, \sigma) = \frac{1}{x \sigma \sqrt{2\pi}} \exp\left(-\frac{(\ln(x) - \mu)^2}{2\sigma^2}\right)$$ 
gdzie:

- \( x \) to zmienna losowa,
- \( \mu \) to rednia logarytmu rozkadu,
- \( \sigma \) to odchylenie standardowe logarytmu rozkadu.

Parametry rozkadu:
$$0<=\mu < \infty$$ $$\sigma > 0$$



```{r, echo=FALSE}
r1 <- rlnorm(100000, 0, 0.125)
r2 <- rlnorm(100000, 0, 10)
r3 <- rlnorm(100000, 0, 1)

# Wykres
plot(density(r1), col = "blue", lwd = 2, main = "Wykres gstoci",
     xlim = c(0, 3), ylim = c(0, 2), xlab = "Wartoci", ylab = "Gsto prawdopodobiestwa")
lines(density(r2), col = "green", lwd = 2)
lines(density(r3), col = "red", lwd = 2)

# Legenda
legend("topright", legend = c("Sigma = 0.125", "Sigma = 10", "Sigma = 1"), 
       col = c("blue", "green", "red"), lwd = 2)
```

呕r贸da:
<br>https://stat.ue.katowice.pl/stat11/logarytmiczno-normalny.html
<br> https://pl.wikipedia.org/wiki/Rozk%C5%82ad_logarytmicznie_normalny

# Badanie
##   = 0, $\sigma$ = $\frac{1}{8}$


W naszej pracy badamy wasnoci estymator贸w Metody Najwikszej Wiarygodnoci rozkadu logarytmiczno - normalnego.

Celem naszego badania jest odpowiedzenie na nastpujce pytania:

- Jak zmienia si dokadno oszacowania w zale偶noci od liczby danych, na podstawie kt贸rych 
szacowane s parametry?
- Jak zmienia si ksztat rozkadu (skono, kurtoza) oszacowanych wartoci parametr贸w w 
zale偶noci od liczby danych, na podstawie kt贸rych szacowane s parametry?
- Czy rozkad oszacowa parametr贸w jest rozkadem normalnym? jak to zale偶y od liczby 
danych?
- Czy zachowanie estymator贸w MNW zale偶y od tego, kt贸ry parametr rozkadu jest szacowany?
- Czy zachowanie estymator贸w MNW r贸偶ni si w zale偶noci od rzeczywistej wartoci 
szacowanego parametru?

Tworzymy funkcj, kt贸ra estymuje parametry Metody Najwikszej Wiarygodnoci dla rozkadu logarytmiczno-normalnego
```{r}
mnw_estimator_ln <- function(data) {
  fit_result <- fitdistr(data, "lognormal")
  return(c(meanlog = fit_result$estimate[1], sdlog = fit_result$estimate[2]))
}
```
Tworzymy funkcj, kt贸ra losuje `n` danych z rozkadu logarytmiczno - normalnego, na kt贸rych podstawie Metod Najwikszej Wiarygodnoci estymuj parametry rozkadu. Powtarza ten krok 300 razy, a dane zapisuje w ramce danych.
```{r}
simulate_mnw <- function(sample_sizes, true_params) {
  results <- data.frame(
    Nr = numeric(),
    True_MeanLog = numeric(),
    True_SDLog = numeric(),
    Estimated_MeanLog = numeric(),
    Estimated_SDLog = numeric(),
    Sample_Size = numeric()
  )
  
  for (n in sample_sizes) {
    for (i in 1:500) {
      simulated_data <- rlnorm(n, meanlog = true_params[1], sdlog = true_params[2])
      
      estimated_params <- mnw_estimator_ln(simulated_data)
      
      result_row <- data.frame(
        Nr = i,
        True_MeanLog = true_params[1],
        True_SDLog = true_params[2],
        Estimated_MeanLog = estimated_params[1],
        Estimated_SDLog = estimated_params[2],
        Sample_Size = n
      )
      
      results <- rbind(results, result_row)
    }
  }
  
  return(results)
}
```
Ustalam liczb danych i parametry rozkadu
```{r}
sample_sizes <- c(10, 20, 50, 100, 500, 1000)
true_params <- c(0, 0.125)
```
Wywouj funckj dla r贸偶nej liczby pr贸bek.
```{r}
simulation_results <- simulate_mnw(sample_sizes, true_params)
```

### rednia logarytmu

Obliczmy statystyki opisowe dla wyestymowanych parametr贸w.
```{r}
summary_stats_meanlog <- simulation_results %>%
  group_by(Sample_Size) %>%
  summarise(
    Mean_MeanLog = mean(Estimated_MeanLog),
    SD_MeanLog = sd(Estimated_MeanLog),
    Kurtosis_MeanLog = kurtosis(Estimated_MeanLog),
    Skewness_MeanLog = skewness(Estimated_MeanLog),
    Shapiro_p_value = shapiro.test(Estimated_MeanLog)$p.value,
    Rozkad_normalny = ifelse(shapiro.test(Estimated_MeanLog)$p.value > 0.05, "Tak", "Nie")
  )

kable(summary_stats_meanlog, "markdown")
```
<br>
Widzimy, 偶e wartoci kurtozy niezale偶nie od liczby danych s bliskie 3, a zatem kurtozie rozkadu normalnego. Skono we wszystkich przypadkach ma niskie wartoci, a wyniki testu Shapiro - Wilka potwierdzaj to, 偶e zmienne maj rozkady normalne.
<br>
Zobaczmy, jak wyniki badania prezentuj si na histogramach:
```{r}
par(mfrow = c(2, 3), mar = c(4, 4, 2, 1))

for (size in sample_sizes) {
  subset_data <- simulation_results[simulation_results$Sample_Size == size, ]
  
  hist(subset_data$Estimated_MeanLog, col = "skyblue", border = "white",
       main = paste("Liczba danych =", size), xlab = "", ylab = "")
}
```
<br>Widzimy, 偶e niezale偶nie od liczby danych najwiksze skupienie danych obserwujemy w okolicy zera, a mniejsze w ogonach.<br>

Wykres pudekowy:
```{r}
ggplot(simulation_results, aes(x = as.factor(Sample_Size), y = Estimated_MeanLog)) +
  geom_boxplot() +
  labs(title = "",
       x = "Wielko pr贸by",
       y = "Srednia logarytmu")
```

<br>Tutaj widzimy, 偶e w miar wzrostu liczby danych, dokadno oszacowania paramteru wzrasta - wartoci wyestymowanych estymator贸w s coraz bardziej skumulowane wok贸 rzeczywistej wartoci .<br>

### Odchylenie standardowe logarytmu

Obliczmy statystyki opisowe dla wyestymowanych parametr贸w.
```{r}
summary_stats_sdlog <- simulation_results %>%
  group_by(Sample_Size) %>%
  summarise(
    Mean_SDLog = mean(Estimated_SDLog),
    SD_SDLog = sd(Estimated_SDLog),
    Kurtosis_SDLog = kurtosis(Estimated_SDLog),
    Skewness_SDLog = skewness(Estimated_SDLog),
    Shapiro_p_value = shapiro.test(Estimated_SDLog)$p.value,
    Rozkad_normalny = ifelse(shapiro.test(Estimated_SDLog)$p.value > 0.05, "Tak", "Nie")
  )

kable(summary_stats_sdlog, "markdown")
```
<br>Obserwujemy podobne wyniki - kurtoza zawsze przyjmuje warto blisk 3, a skono jest stosunkowo niewielka. Niezale偶nie od liczby danych, rozkad estymatora jest rozkadem normalnym.<br>
Zobaczmy, jak wyniki badania prezentuj si na histogramach:
```{r}
par(mfrow = c(2, 3), mar = c(4, 4, 2, 1))

for (size in sample_sizes) {
  subset_data <- simulation_results[simulation_results$Sample_Size == size, ]
  
  hist(subset_data$Estimated_SDLog, col = "skyblue", border = "white",
       main = paste("Liczba danych =", size), xlab = "", ylab = "")
}
```
<br>Znowu obserwujemy wiksze zagszczenie danych wok贸 0 (co jest dobr wieci, gdy偶 warto estymowanego przez nas parametru wynosi 0.125), a mniejsze na brzegach rozkadu.<br>
Wykres pudekowy:
```{r}
ggplot(simulation_results, aes(x = as.factor(Sample_Size), y = Estimated_SDLog)) +
  geom_boxplot() +
  labs(title = "",
       x = "Wielko pr贸by",
       y = "Odchylenie standardowe logarytmu")
```
<br>Znowu obserwujemy wzrost dokadnoci oszacowania wraz ze wzrostem liczby danych.

##  = 0, $\sigma$ = 10
```{r}
true_params2 <- c(0, 10)
```
Wywouj funckj dla r贸偶nej liczby pr贸bek.
```{r}
simulation_results2 <- simulate_mnw(sample_sizes, true_params2)
```

### rednia logarytmu

Obliczmy statystyki opisowe dla wyestymowanych parametr贸w.
```{r}
summary_stats_meanlog2 <- simulation_results2 %>%
  group_by(Sample_Size) %>%
  summarise(
    Mean_MeanLog = mean(Estimated_MeanLog),
    SD_MeanLog = sd(Estimated_MeanLog),
    Kurtosis_MeanLog = kurtosis(Estimated_MeanLog),
    Skewness_MeanLog = skewness(Estimated_MeanLog),
    Shapiro_p_value = shapiro.test(Estimated_MeanLog)$p.value,
    Rozkad_normalny = ifelse(shapiro.test(Estimated_MeanLog)$p.value > 0.05, "Tak", "Nie")
  )
kable(summary_stats_meanlog2, "markdown")
```
<br>Znowu widzimy podobiestwa do rozkadu normalnego niezale偶nie od iloci danych - kurtoza bliska 3, niska skono. Wyniki testu Shapiro - Wilka wskazuj na to, 偶e cechy (znowu niezale偶nie od liczby danych) maj rozkad normalny.<br>
Zobaczmy, jak wyniki badania prezentuj si na histogramach:
```{r}
par(mfrow = c(2, 3), mar = c(4, 4, 2, 1))

for (size in sample_sizes) {
  subset_data2 <- simulation_results2[simulation_results2$Sample_Size == size, ]
  
  hist(subset_data2$Estimated_MeanLog, col = "skyblue", border = "white",
       main = paste("Liczba danych =", size), xlab = "", ylab = "")
}
```
<br>Podobnie jak wczeniej - du偶a koncentracja danych wok贸 0 oraz niska na brzegach.<br>
Wykres pudekowy:
```{r}
ggplot(simulation_results2, aes(x = as.factor(Sample_Size), y = Estimated_MeanLog)) +
  geom_boxplot() +
  labs(title = "",
       x = "Wielko pr贸by",
       y = "Srednia logarytmu")
```
<br>Tutaj znowu obserwujemy zwikszenie dokadnoci oszacowania wraz ze wzrostem danych.<br>

### Odchylenie standardowe logarytmu

Obliczmy statystyki opisowe dla wyestymowanych parametr贸w.
```{r}
summary_stats_sdlog3 <- simulation_results2 %>%
  group_by(Sample_Size) %>%
  summarise(
    Mean_SDLog = mean(Estimated_SDLog),
    SD_SDLog = sd(Estimated_SDLog),
    Kurtosis_SDLog = kurtosis(Estimated_SDLog),
    Skewness_SDLog = skewness(Estimated_SDLog),
    Shapiro_p_value = shapiro.test(Estimated_SDLog)$p.value,
    Rozkad_normalny = ifelse(shapiro.test(Estimated_SDLog)$p.value > 0.05, "Tak", "Nie")
  )

kable(summary_stats_sdlog3, "markdown")
```
<br>Niezale偶nie od liczby danych, przecitna warto estymatora jest bliska rzeczywistej wartoci estymatora, a cecha ma rozkad normalny we wszystkich przypadkach.<br>
Zobaczmy, jak wyniki badania prezentuj si na histogramach:
```{r}
par(mfrow = c(2, 3), mar = c(4, 4, 2, 1))

for (size in sample_sizes) {
  subset_data3 <- simulation_results2[simulation_results2$Sample_Size == size, ]
  
  hist(subset_data3$Estimated_SDLog, col = "skyblue", border = "white",
       main = paste("Liczba danych =", size), xlab = "", ylab = "")
}
```
<br>Widzimy du偶e zagszczenie danych wok贸 10 w ka偶dym przypadku, a mae zagszczenie po brzegach.
Wykres pudekowy:
```{r}
ggplot(simulation_results2, aes(x = as.factor(Sample_Size), y = Estimated_SDLog)) +
  geom_boxplot() +
  labs(title = "",
       x = "Wielko pr贸by",
       y = "Odchylenie standardowe logarytmu")
```
<br>Znowu widzimy, 偶e wraz ze wzrostem liczby danych, wartoci estymator贸w s coraz mocniej skumulowane wok贸 rzeczywistej wartoci $\sigma$.

##  = 0, $\sigma$ = 1
```{r}
true_params3 <- c(0, 1)
```
Wywouj funckj dla r贸偶nej liczby pr贸bek.
```{r}
simulation_results3<- simulate_mnw(sample_sizes, true_params3)
```

### rednia logarytmu

Obliczmy statystyki opisowe dla wyestymowanych parametr贸w.
```{r}
summary_stats_meanlog4 <- simulation_results3 %>%
  group_by(Sample_Size) %>%
  summarise(
    Mean_MeanLog = mean(Estimated_MeanLog),
    SD_MeanLog = sd(Estimated_MeanLog),
    Kurtosis_MeanLog = kurtosis(Estimated_MeanLog),
    Skewness_MeanLog = skewness(Estimated_MeanLog),
    Shapiro_p_value = shapiro.test(Estimated_MeanLog)$p.value,
    Rozkad_normalny = ifelse(shapiro.test(Estimated_MeanLog)$p.value > 0.05, "Tak", "Nie")
  )

kable(summary_stats_meanlog4, "markdown")
```
<br>Niezale偶nie od liczby danych estymatory maj rozkad normalny<br>
Zobaczmy, jak wyniki badania prezentuj si na histogramach:
```{r}
par(mfrow = c(2, 3), mar = c(4, 4, 2, 1))

for (size in sample_sizes) {
  subset_data4 <- simulation_results3[simulation_results3$Sample_Size == size, ]
  
  hist(subset_data3$Estimated_MeanLog, col = "skyblue", border = "white",
       main = paste("Liczba danych =", size), xlab = "", ylab = "")
}
```
<br>Najwiksze zagszczenie woko zera, niskie zagszczenie danych na brzegach.<br>
Wykres pudekowy:
```{r}
ggplot(simulation_results3, aes(x = as.factor(Sample_Size), y = Estimated_MeanLog)) +
  geom_boxplot() +
  labs(title = "",
       x = "Wielko pr贸by",
       y = "rednia logarytmu")
```
<br>Znowu - dokadno dopasowania wzrasta wzraz ze wzrostem liczby danych.<br>

### Odchylenie standardowe logarytmu

Obliczmy statystyki opisowe dla wyestymowanych parametr贸w.
```{r}
summary_stats_sdlog5 <- simulation_results3 %>%
  group_by(Sample_Size) %>%
  summarise(
    Mean_SDLog = mean(Estimated_SDLog),
    SD_SDLog = sd(Estimated_SDLog),
    Kurtosis_SDLog = kurtosis(Estimated_SDLog),
    Skewness_SDLog = skewness(Estimated_SDLog),
    Shapiro_p_value = shapiro.test(Estimated_SDLog)$p.value,
    Rozkad_normalny = ifelse(shapiro.test(Estimated_SDLog)$p.value > 0.05, "Tak", "Nie")
  )
kable(summary_stats_sdlog5, "markdown")
```
<br>Niezale偶nie od liczby losowanych danych, na podstawie kt贸rych szacujemy parametry, rozkad oszacowa parametr贸w jest rozkadem normalnym. Wnioskujemy to na podstawie kurtozy, skonoci oraz wyniku testu Shapiro - Wilka. <br>
Zobaczmy, jak wyniki badania prezentuj si na histogramach:
```{r}
par(mfrow = c(2, 3), mar = c(4, 4, 2, 1))

for (size in sample_sizes) {
  subset_data5 <- simulation_results3[simulation_results3$Sample_Size == size, ]
  
  hist(subset_data5$Estimated_SDLog, col = "skyblue", border = "white",
       main = paste("Liczba danych =", size), xlab = "", ylab = "")
}
```
<br>Wszystkie histogramy wygldaj podobnie. Du偶e zagszczenie danych wok贸 zera, mae zagszczenie po brzegach.<br>
Wykres pudekowy:
```{r}
ggplot(simulation_results3, aes(x = as.factor(Sample_Size), y = Estimated_SDLog)) +
  geom_boxplot() +
  labs(title = "",
       x = "Wielko pr贸by",
       y = "Odchylenie standardowe logarytmu")
```
<br>Wraz ze wzrostem liczby danych, wyniki mocniej skupiaj si wok贸 rzeczywistej wartoci estymowanego parametru<br>

##  = -3, $\sigma$ = 1
```{r}
true_params4 <- c(-3, 1)
```
Wywouj funckj dla r贸偶nej liczby pr贸bek.
```{r}
simulation_results4<- simulate_mnw(sample_sizes, true_params4)
```

### rednia logarytmu

Obliczmy statystyki opisowe dla wyestymowanych parametr贸w.
```{r}
summary_stats_meanlog6 <- simulation_results4 %>%
  group_by(Sample_Size) %>%
  summarise(
    Mean_MeanLog = mean(Estimated_MeanLog),
    SD_MeanLog = sd(Estimated_MeanLog),
    Kurtosis_MeanLog = kurtosis(Estimated_MeanLog),
    Skewness_MeanLog = skewness(Estimated_MeanLog),
    Shapiro_p_value = shapiro.test(Estimated_MeanLog)$p.value,
    Rozkad_normalny = ifelse(shapiro.test(Estimated_MeanLog)$p.value > 0.05, "Tak", "Nie")
  )
kable(summary_stats_meanlog6, "markdown")
```
<br>Niezale偶nie od liczby danych mo偶emy wysnu takie same wnioski co poprzednio odnonie ksztatu rozkadu - Rozkady wystestymowanych parametr贸w to rozkady normalne.<br>
Zobaczmy, jak wyniki badania prezentuj si na histogramach:
```{r}
par(mfrow = c(2, 3), mar = c(4, 4, 2, 1))

for (size in sample_sizes) {
  subset_data6 <- simulation_results4[simulation_results4$Sample_Size == size, ]
  
  hist(subset_data6$Estimated_MeanLog, col = "skyblue", border = "white",
       main = paste("Liczba danych =", size), xlab = "", ylab = "")
}
```
<br>Niezale偶nie od liczby danych - du偶e zagszczenie danych wok贸 -3 (rzeczywistej wartoci redniej logarytmu).<br>
Wykres pudekowy:
```{r}
ggplot(simulation_results4, aes(x = as.factor(Sample_Size), y = Estimated_MeanLog)) +
  geom_boxplot() +
  labs(title = "",
       x = "Wielko pr贸by",
       y = "rednia logarytmu")
```
<br>Wraz ze wzrostem liczby danych - rozkady wyestymowanych parametr贸w s mocniej skupione wok贸 -3.

### Odchylenie standardowe logarytmu

Obliczmy statystyki opisowe dla wyestymowanych parametr贸w.
```{r}
summary_stats_sdlog7 <- simulation_results4 %>%
  group_by(Sample_Size) %>%
  summarise(
    Mean_SDLog = mean(Estimated_SDLog),
    SD_SDLog = sd(Estimated_SDLog),
    Kurtosis_SDLog = kurtosis(Estimated_SDLog),
    Skewness_SDLog = skewness(Estimated_SDLog),
    Shapiro_p_value = shapiro.test(Estimated_SDLog)$p.value,
    Rozkad_normalny = ifelse(shapiro.test(Estimated_SDLog)$p.value > 0.05, "Tak", "Nie")
  )
kable(summary_stats_sdlog7, "markdown")
```
<br>Tutaj obserwujemy pewne zmiany - wyniki test贸w dla symulacji, gdzie losowalimy 20 i 100 danych wskazuj na to, 偶e musimy odrzuci hipotez o normalnoci rozkadu. Jednak偶e we wszystkich przypadkach wartoci kurtoz s zbli偶one do wartoci kurtozy rozkadu normalnego, podobnie ze skonociami w tych rozkadach.<br>
Zobaczmy, jak wyniki badania prezentuj si na histogramach:
```{r}
par(mfrow = c(2, 3), mar = c(4, 4, 2, 1))

for (size in sample_sizes) {
  subset_data7 <- simulation_results4[simulation_results4$Sample_Size == size, ]
  
  hist(subset_data7$Estimated_SDLog, col = "skyblue", border = "white",
       main = paste("Liczba danych =", size), xlab = "", ylab = "")
}
```
<br>Du偶e skoncentrowanie danych wok贸 1.<br>
Wykres pudekowy
```{r}
ggplot(simulation_results4, aes(x = as.factor(Sample_Size), y = Estimated_SDLog)) +
  geom_boxplot() +
  labs(title = "",
       x = "Wielko pr贸by",
       y = "Odchylenie standardowe logarytmu")
```
<br>Wraz ze wzrostem danych rozkady oszacowanych estymator贸w s coraz bardziej skupione wok贸 rzeczywistej wartoci odchylenia standardowego logarytmu.<br>

##  = 5, $\sigma$ = 1
```{r}
true_params5 <- c(5, 1)
```
Wywouj funckj dla r贸偶nej liczby pr贸bek.
```{r}
simulation_results5<- simulate_mnw(sample_sizes, true_params5)
```

### rednia logarytmu

Obliczmy statystyki opisowe dla wyestymowanych parametr贸w.
```{r}
summary_stats_meanlog8 <- simulation_results5 %>%
  group_by(Sample_Size) %>%
  summarise(
    Mean_MeanLog = mean(Estimated_MeanLog),
    SD_MeanLog = sd(Estimated_MeanLog),
    Kurtosis_MeanLog = kurtosis(Estimated_MeanLog),
    Skewness_MeanLog = skewness(Estimated_MeanLog),
    Shapiro_p_value = shapiro.test(Estimated_MeanLog)$p.value,
    Rozkad_normalny = ifelse(shapiro.test(Estimated_MeanLog)$p.value > 0.05, "Tak", "Nie")
  )
kable(summary_stats_meanlog8, "markdown")
```
<br>Widzimy, 偶e dla n = 50 wynik p_value zmusza do odrzucenia hipotezy o normalnoci rozkadu. Jednak偶e podobnie jak w poprzednim przypadku - warto kurtozy jest bliska 3, a obliczona skono ma nisk warto, co wskazuje na symetryczno rozkadu.<br>
Zobaczmy, jak wyniki badania prezentuj si na histogramach:
```{r}
par(mfrow = c(2, 3), mar = c(4, 4, 2, 1))

for (size in sample_sizes) {
  subset_data8 <- simulation_results5[simulation_results5$Sample_Size == size, ]
  
  hist(subset_data8$Estimated_MeanLog, col = "skyblue", border = "white",
       main = paste("Liczba danych =", size), xlab = "", ylab = "")
}
```
<br>Dane mocno skupione wok贸 5.<br>
Wykres pudekowy:
```{r}
ggplot(simulation_results5, aes(x = as.factor(Sample_Size), y = Estimated_MeanLog)) +
  geom_boxplot() +
  labs(title = "",
       x = "Wielko pr贸by",
       y = "rednia logarytmu")
```
<br>Wraz ze wzrostem danych zwiksza si dokadno oszacowa redniej logarytmu.

### Odchylenie standardowe logarytmu

Obliczmy statystyki opisowe dla wyestymowanych parametr贸w.
```{r}
summary_stats_sdlog9 <- simulation_results5 %>%
  group_by(Sample_Size) %>%
  summarise(
    Mean_SDLog = mean(Estimated_SDLog),
    SD_SDLog = sd(Estimated_SDLog),
    Kurtosis_SDLog = kurtosis(Estimated_SDLog),
    Skewness_SDLog = skewness(Estimated_SDLog),
    Shapiro_p_value = shapiro.test(Estimated_SDLog)$p.value,
    Rozkad_normalny = ifelse(shapiro.test(Estimated_SDLog)$p.value > 0.05, "Tak", "Nie")
  )
kable(summary_stats_sdlog9, "markdown")
```
<br>Tutaj podobnie jak poprzednio w kilku przypadkach odrzucamy hipotez o normalnoci rozkad贸w, jednak偶e obliczone statystyki wskazuj na podobiestwo rozkad贸w oszacowanych parametr贸w do rozkadu normalnego.<br>
Zobaczmy, jak wyniki badania prezentuj si na histogramach:
```{r}
par(mfrow = c(2, 3), mar = c(4, 4, 2, 1))

for (size in sample_sizes) {
  subset_data9 <- simulation_results5[simulation_results5$Sample_Size == size, ]
  
  hist(subset_data9$Estimated_SDLog, col = "skyblue", border = "white",
       main = paste("Liczba danych =", size), xlab = "", ylab = "")
}
```
<br>Dane skupione wok贸 1.<br>
Wykres pudekowy:
```{r}
ggplot(simulation_results5, aes(x = as.factor(Sample_Size), y = Estimated_SDLog)) +
  geom_boxplot() +
  labs(title = "",
       x = "Wielko pr贸by",
       y = "Odchylenie standardowe logarytmu")
```
<br>Tutaj widzimy, 偶e w miar wzrostu liczby danych, dokadno oszacowania paramteru wzrasta - wartoci wyestymowanych estymator贸w s coraz bardziej skumulowane wok贸 rzeczywistej wartoci $\sigma$<br>

# Podsumowanie
- **Dokadno estymacji wzrasta wraz ze wzrostem liczby danych**: Wszystkie nasze badania wykazay, 偶e w miar zwikszania liczby danych estymatory MNW byy coraz bardziej skumulowane wok贸 rzeczywistych wartoci parametr贸w. Dla maych pr贸bek mielimy mniejsz dokadno, ale w miar wzrostu pr贸bki estymacje staway si bardziej precyzyjne.
- **Ksztat rozkadu estymator贸w**: W wikszoci przypadk贸w rozkady estymator贸w dla obu parametr贸w (redniej logarytmu i odchylenia standardowego logarytmu) wykazyway podobiestwo do rozkadu normalnego. Testy statystyczne potwierdzay, 偶e w wikszoci przypadk贸w mo偶na zao偶y normalno tych rozkad贸w.
- **Zale偶no dokadnoci od rzeczywistej wartoci szacowanego parametru**: Nie zaobserwowalimy znaczcych r贸偶nic w zachowaniu estymator贸w MNW w zale偶noci od konkretnych wartoci rzeczywistych parametr贸w rozkadu. Dokadno estymacji wydaje si by stabilna w r贸偶nych scenariuszach.
- **Zachowanie estymator贸w MNW nie zale偶y od tego, kt贸ry parametr jest estymowany**: We wszystkich przypadkach dochodzilimy do tych samych wniosk贸w.
- **Testy normalnoci**: W niekt贸rych przypadkach testy normalnoci wskazyway na potencjalne odstpstwa od normalnoci, zwaszcza dla mniejszych pr贸bek. Niemniej jednak, analiza kurtozy i skonoci oraz ocena histogram贸w sugeruj, 偶e r贸偶nice te mog by niewielkie. W zdecydowanej wikszoci przypadk贸w rozkad oszacowa parametr贸w by rozkadem normalnym.